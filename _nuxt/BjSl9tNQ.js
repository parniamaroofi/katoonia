import{_ as B}from"./BLTjAdUL.js";import{_ as P,t as g,v as c,x as l,z as s,A as n,V as p,B as d,C as y,D as A,E as b,F as O,G as R,H as J,I as M,J as G,K as H,y as u,L as K,M as Q,N as I,O as q,P as f,Q as C,R as w,S as D,T as U,f as r,U as W}from"./DaplssYx.js";import{C as F,a as X,b as Y}from"./Bn6PYqT_.js";import"./Dudy9OWa.js";const Z={name:"DigitizeFrontendCategories",setup(){const t=r([]),e=r(""),x=r(8),a=r(""),k=r(!1),i=r(1),h=r(3),o=r(!0),m=r({}),v=r({}),E=r(!1),V=r(!1),j=r(!1),T=r(!1),z=r(!1),L=r(!1),N=r({name:""}),S=W([{title:"#",key:"index",sortable:!1},{title:"آیکون",key:"icon",sortable:!1},{title:"تصویر",key:"image",sortable:!1},{title:"عنوان",key:"name"},{title:"عملیات",key:"actions",align:"center",sortable:!1}]);return{items:t,search:e,columns:S,perPage:x,loading:k,category:N,dialogType:a,currentPage:i,totalRecords:h,tableLoading:o,iconFileError:E,imageFileError:V,isIconUploaded:T,categoryDialog:j,isImageUploaded:z,uploadedIconFile:m,uploadedImageFile:v,deleteConfirmation:L}},mounted(){this.getData()},methods:{actionItems(t){return[{icon:"svg:edit",title:"ویرایش",function:()=>this.openDialog("edit",t)},{icon:"svg:trash",title:"حذف",function:()=>this.showConfirmation(t)}]},getData(){this.tableLoading=!0,this.$axios.get(F).then(t=>{this.items=t.data,this.tableLoading=!1}).catch(t=>{this.tableLoading=!1})},addCatgory(){this.loading=!0;const t=new FormData;console.log(this.uploadedIconFile),t.append("Name",this.category.name),t.append("Icon",this.uploadedIconFile),t.append("Image",this.uploadedImageFile),this.$axios.post(F,t,{headers:{"Content-Type":"multipart/form-data"}}).then(e=>{this.refreshData(),this.$toast.success(e.data.message),this.loading=!1}).catch(e=>{this.loading=!1})},async editCategory(){try{this.loading=!0;const t=new FormData;t.append("Id",this.category.id),t.append("Name",this.category.name);const e=[];this.isIconUploaded&&e.push(this.editIcon()),this.isImageUploaded&&e.push(this.editImage()),await Promise.all(e);const x=await this.$axios.put(F,t,{headers:{"Content-Type":"multipart/form-data"}});this.refreshData(),this.$toast.success(x.data.message)}catch(t){console.error(t),this.$toast.error("خطایی رخ داده است. مجددا تلاش کنید")}finally{this.loading=!1}},async editIcon(){const t=new FormData;t.append("Id",this.category.id),t.append("Icon",this.uploadedIconFile),await this.$axios.put(Y,t,{headers:{"Content-Type":"multipart/form-data"}})},async editImage(){const t=new FormData;t.append("Id",this.category.id),t.append("Image",this.uploadedImageFile),await this.$axios.put(X,t,{headers:{"Content-Type":"multipart/form-data"}})},refreshData(){this.category={name:"",icon:"",image:""},this.getData(),this.categoryDialog=!1},openDialog(t,e){e&&(this.category=JSON.parse(JSON.stringify(e))),t=="new"&&(this.category={name:"",icon:"",image:""}),this.uploadedImageFile={},this.uploadedIconFile={},this.iconFileError=!1,this.isIconUploaded=!1,this.imageFileError=!1,this.isImageUploaded=!1,this.dialogType=t,this.categoryDialog=!0},showConfirmation(t){this.category=JSON.parse(JSON.stringify(t)),this.deleteConfirmation=!0},updateList(){},uploadIconFile(t){this.uploadedIconFile=t.target.files[0];var e=3*1024*1024;this.uploadedIconFile.size>e?(this.uploadedIconFile={},this.iconFileError=!0):(this.iconFileError=!1,this.isIconUploaded=!0)},uploadImageFile(t){this.uploadedImageFile=t.target.files[0];var e=3*1024*1024;this.uploadedImageFile.size>e?(this.uploadedImageFile={},this.imageFileError=!0):(this.imageFileError=!1,this.isImageUploaded=!0)},dragover(t){t.preventDefault()},dropIconFile(t){t.preventDefault(),this.uploadedIconFile=t.dataTransfer.files[0];var e=3*1024*1024;this.uploadedIconFile.size>e?(this.uploadedIconFile={},this.iconFileError=!0):(this.iconFileError=!1,this.isIconUploaded=!0)},dropImageFile(t){t.preventDefault(),this.uploadedImageFile=t.dataTransfer.files[0];var e=3*1024*1024;this.uploadedImageFile.size>e?(this.uploadedImageFile={},this.imageFileError=!0):(this.imageFileError=!1,this.isImageUploaded=!0)},openIconFile(){if(this.isIconUploaded){const t=document.createElement("a");t.href=URL.createObjectURL(this.uploadedIconFile),t.target="_blank",t.click()}else{const t=document.createElement("a");t.href=`${this.uploadedIconFile.url}`,t.target="_blank",t.click()}},openImageFile(){if(this.isImageUploaded){const t=document.createElement("a");t.href=URL.createObjectURL(this.uploadedImageFile),t.target="_blank",t.click()}else{const t=document.createElement("a");t.href=`${this.uploadedImageFile.url}`,t.target="_blank",t.click()}},showImage(t){if(t){const e=document.createElement("a");e.href=`${this.$cdnUrl}${t.image}`,e.target="_blank",e.click()}else{const e=document.createElement("a");e.href=`${this.$cdnUrl}${this.category.image}`,e.target="_blank",e.click()}},showIcon(t){if(t){const e=document.createElement("a");e.href=`${this.$cdnUrl}${t.icon}`,e.target="_blank",e.click()}else{const e=document.createElement("a");e.href=`${this.$cdnUrl}${this.category.icon}`,e.target="_blank",e.click()}},errorImage(t){t.target.src="/images/product.png"},doDelete(){this.loading=!0,this.$axios.delete(F+"/"+this.category.id).then(t=>{this.refreshData(),this.deleteConfirmation=!1,this.$toast.success(t.data.message),this.loading=!1}).catch(t=>{this.loading=!1})}}},_={class:"h-full"},$={class:"text-left mb-1 flex justify-between gap-x-4"},ee={class:"h-[calc(100%-50px)] mt-6"},te=["onClick","src"],ae={class:"py-1"},le=["onClick","src"],oe={class:"flex gap-x-2.5 items-center px-1"},ie={class:"text-[12.5px] text-gray-500 font-semibold"},se={class:"bg-gray-100 p-4 flex justify-between align-center"},ne={class:"text-[18px]"},re={class:"p-6"},de={class:"grid grid-cols-2 gap-x-6"},me={class:"text-primary"},ge={key:0,class:"text-primary text-[14px] font-semibold"},ce={key:1,class:"text-[14px] text-[#63ca9f] font-semibold"},pe={key:0,class:"text-[#FA2D11] font-semibold mt-2"},fe={class:"text-primary"},ue={key:0,class:"text-primary text-[14px] font-semibold"},Ie={key:1,class:"text-[14px] text-[#63ca9f] font-semibold"},xe={key:0,class:"text-[#FA2D11] font-semibold mt-2"},he={class:"p-5 text-center"},ye={class:"flex justify-between align-center bg-[#FA2D110D] w-fit pa-5 rounded-[8px] mx-auto mb-5"},Fe={class:"text-[14px] mt-1"},ve={class:"font-bold"},be={class:"mt-6 flex justify-between w-full"};function ke(t,e,x,a,k,i){const h=B;return g(),c("div",_,[l("div",$,[e[24]||(e[24]=l("div",{class:"w-full"},null,-1)),s(y,{class:"btn bg-primary h-[48px] w-[180px]",onClick:e[0]||(e[0]=o=>i.openDialog("new"))},{default:n(()=>[s(p,{class:"ml-1 stroke-white",size:"small"},{default:n(()=>e[22]||(e[22]=[d("svg:plus")])),_:1}),e[23]||(e[23]=d(" افزودن دسته‌بندی "))]),_:1})]),l("section",ee,[s(Q,{items:a.items,headers:a.columns,loading:a.tableLoading,"fixed-header":"","no-data-text":"آیتمی برای نمایش وجود ندارد","hide-default-footer":"",class:"h-full rounded-[10px]"},{"item.index":n(({index:o})=>[l("div",null,u((a.currentPage-1)*a.perPage+1+o),1)]),"item.icon":n(({item:o})=>[l("div",null,[l("img",{onClick:m=>i.showIcon(o),src:`${t.$cdnUrl}${o.icon}`,onError:e[1]||(e[1]=(...m)=>i.errorImage&&i.errorImage(...m)),class:"size-12 object-contain rounded-[4px] cursor-pointer"},null,40,te)])]),"item.image":n(({item:o})=>[l("div",ae,[l("img",{onClick:m=>i.showImage(o),src:`${t.$cdnUrl}${o.image}`,onError:e[2]||(e[2]=(...m)=>i.errorImage&&i.errorImage(...m)),class:"size-12 object-contain rounded-lg cursor-pointer"},null,40,le)])]),"item.actions":n(({item:o})=>[l("div",null,[s(A,{transition:"scale-transition"},{activator:n(({props:m})=>[s(p,K({color:"grey"},m),{default:n(()=>e[25]||(e[25]=[d("mdi-dots-vertical")])),_:2},1040)]),default:n(()=>[s(b,null,{default:n(()=>[s(O,{density:"comfortable"},{default:n(()=>[(g(!0),c(R,null,J(i.actionItems(o),(m,v)=>(g(),M(G,{key:v,onClick:m.function,class:"pl-10"},{default:n(()=>[s(H,null,{default:n(()=>[l("div",oe,[s(p,{icon:m.icon,class:"fill-[#7A7A7A] text-[21px]"},null,8,["icon"]),l("span",ie,u(m.title),1)])]),_:2},1024)]),_:2},1032,["onClick"]))),128))]),_:2},1024)]),_:2},1024)]),_:2},1024)])]),_:2},1032,["items","headers","loading"])]),s(U,{modelValue:a.categoryDialog,"onUpdate:modelValue":e[18]||(e[18]=o=>a.categoryDialog=o),width:"800",persistent:""},{default:n(()=>[s(b,{class:"rounded-large"},{default:n(()=>[l("div",se,[l("span",ne,u(a.dialogType=="new"?"ایجاد دسته‌بندی جدید":"ویرایش دسته‌بندی"),1),s(p,{size:"large",color:"red",onClick:e[3]||(e[3]=o=>a.categoryDialog=!1),class:I(a.loading?"pointer-events-none opacity-50":"")},{default:n(()=>e[26]||(e[26]=[d("mdi-close-circle-outline")])),_:1},8,["class"])]),l("div",re,[l("div",null,[e[27]||(e[27]=l("label",{class:"text-[14px] font-semibold"},"* عنوان دسته‌بندی:",-1)),s(q,{modelValue:a.category.name,"onUpdate:modelValue":e[4]||(e[4]=o=>a.category.name=o),class:"mt-1.5",color:"primary",variant:"outlined",density:"comfortable",placeholder:"عنوان مورد نظر را وارد کنید..."},null,8,["modelValue"])]),l("div",de,[l("section",null,[l("div",null,[e[32]||(e[32]=l("label",{class:"text-[14px] font-semibold"},"* آیکون دسته‌بندی",-1)),a.category.icon?(g(),c("div",{key:0,class:"pt-2 text-[13px] cursor-pointer",onClick:e[5]||(e[5]=o=>i.showIcon())},[e[30]||(e[30]=l("span",null,"آیکون فعلی:",-1)),l("span",me,[s(p,{class:"stroke-primary mr-2 ml-1"},{default:n(()=>e[28]||(e[28]=[d("svg:show")])),_:1}),e[29]||(e[29]=d("مشاهده آیکون"))])])):f("",!0),l("div",{class:I(["pt-8 p-5 mt-3 text-center upload-box min-h-[169px] flex flex-col justify-center items-center",!a.uploadedIconFile.name||!a.isIconUploaded?" cursor-pointer":""]),onDragover:e[8]||(e[8]=(...o)=>i.dragover&&i.dragover(...o)),onDrop:e[9]||(e[9]=(...o)=>i.dropIconFile&&i.dropIconFile(...o)),onClick:e[10]||(e[10]=o=>a.uploadedIconFile.name?"":t.$refs.iconFile.click())},[l("div",null,[s(p,{onClick:e[6]||(e[6]=o=>a.uploadedIconFile.name?t.$refs.iconFile.click():""),icon:!a.uploadedIconFile.name||!a.isIconUploaded?"svg:upload":"svg:successUpload",class:"mb-6 scale-[2]"},null,8,["icon"])]),a.uploadedIconFile.name?f("",!0):(g(),c("p",ge,e[31]||(e[31]=[d(" برای بارگذاری کلیک کنید "),l("br",null,null,-1),d(" و یا فایل را به داخل کادر بکشید. ")]))),a.uploadedIconFile.name&&a.isIconUploaded?(g(),c("p",ce," تصویر با موفقیت بارگذاری شد ")):f("",!0),l("p",{onClick:e[7]||(e[7]=o=>a.uploadedIconFile.name?i.openIconFile():""),class:I(["text-gray-400 text-[12px] mt-1 line-clamp-1 w-[90%]",a.uploadedIconFile.name&&a.isIconUploaded?"cursor-pointer hover:text-primary/80":""])},u(a.uploadedIconFile.name?a.uploadedIconFile.name:"png / jpg / jpeg / webp (max. 3mb)"),3)],34),C(s(w,{accept:".png,.jpg,.svg,.jpeg,.webp",ref:"iconFile",onChange:i.uploadIconFile},null,8,["onChange"]),[[D,!1]])]),a.iconFileError?(g(),c("div",pe,e[33]||(e[33]=[l("span",{class:"text-[13px]"}," حجم فایل آیکون مورد نظر، بیش از حد مجاز است! ",-1)]))):f("",!0)]),l("section",null,[l("div",null,[e[38]||(e[38]=l("label",{class:"text-[14px] font-semibold"},"* تصویر دسته‌بندی",-1)),a.category.image?(g(),c("div",{key:0,class:"pt-2 text-[13px] cursor-pointer",onClick:e[11]||(e[11]=o=>i.showImage())},[e[36]||(e[36]=l("span",null,"تصویر فعلی:",-1)),l("span",fe,[s(p,{class:"stroke-primary mr-2 ml-1"},{default:n(()=>e[34]||(e[34]=[d("svg:show")])),_:1}),e[35]||(e[35]=d("مشاهده تصویر"))])])):f("",!0),l("div",{class:I(["pt-8 p-5 mt-3 text-center upload-box min-h-[169px] flex flex-col justify-center items-center",!a.uploadedImageFile.name||!a.isImageUploaded?" cursor-pointer":""]),onDragover:e[14]||(e[14]=(...o)=>i.dragover&&i.dragover(...o)),onDrop:e[15]||(e[15]=(...o)=>i.dropImageFile&&i.dropImageFile(...o)),onClick:e[16]||(e[16]=o=>a.uploadedImageFile.name?"":t.$refs.imageFile.click())},[l("div",null,[s(p,{onClick:e[12]||(e[12]=o=>a.uploadedImageFile.name?t.$refs.imageFile.click():""),icon:!a.uploadedImageFile.name||!a.isImageUploaded?"svg:upload":"svg:successUpload",class:"mb-6 scale-[2]"},null,8,["icon"])]),a.uploadedImageFile.name?f("",!0):(g(),c("p",ue,e[37]||(e[37]=[d(" برای بارگذاری کلیک کنید "),l("br",null,null,-1),d(" و یا فایل را به داخل کادر بکشید. ")]))),a.uploadedImageFile.name&&a.isImageUploaded?(g(),c("p",Ie," تصویر با موفقیت بارگذاری شد ")):f("",!0),l("p",{onClick:e[13]||(e[13]=o=>a.uploadedImageFile.name?i.openImageFile():""),class:I(["text-gray-400 text-[12px] mt-1 line-clamp-1 w-[90%]",a.uploadedImageFile.name&&a.isImageUploaded?"cursor-pointer hover:text-primary/80":""])},u(a.uploadedImageFile.name?a.uploadedImageFile.name:"png / jpg / jpeg / webp (max. 3mb)"),3)],34),C(s(w,{accept:".png,.jpg,.svg,.jpeg,.webp",ref:"imageFile",onChange:i.uploadImageFile},null,8,["onChange"]),[[D,!1]])]),a.imageFileError?(g(),c("div",xe,e[39]||(e[39]=[l("span",{class:"text-[13px]"}," حجم فایل تصویر مورد نظر، بیش از حد مجاز است! ",-1)]))):f("",!0)])]),s(y,{block:"",color:"primary",onClick:e[17]||(e[17]=o=>a.dialogType=="new"?i.addCatgory():i.editCategory()),loading:a.loading,disabled:!a.category.name||!a.uploadedImageFile.name&&!a.category.image||!a.uploadedIconFile.name&&!a.category.icon,class:"btn h-[48px] mt-6"},{loader:n(()=>[s(h)]),default:n(()=>[d(" "+u(a.dialogType=="new"?"ایجاد دسته‌بندی":"ذخیره‌سازی"),1)]),_:1},8,["loading","disabled"])])]),_:1})]),_:1},8,["modelValue"]),s(U,{modelValue:a.deleteConfirmation,"onUpdate:modelValue":e[21]||(e[21]=o=>a.deleteConfirmation=o),width:"350"},{default:n(()=>[s(b,{class:"rounded-[24px]"},{default:n(()=>[l("div",he,[l("div",ye,[s(p,{icon:"svg:bigTrash"})]),e[44]||(e[44]=l("span",{class:"text-[18px] font-semibold"},"حذف دسته‌بندی",-1)),l("p",Fe,[e[40]||(e[40]=d(" آیا دسته‌بندی ")),l("span",ve,u(a.category.name),1),e[41]||(e[41]=d(" را حذف می‌کنید؟ "))]),l("div",be,[s(y,{flat:"",color:"red",height:"42",class:"w-[calc(100%/2-8px)]",onClick:e[19]||(e[19]=o=>i.doDelete()),loading:a.loading},{loader:n(()=>[s(h)]),default:n(()=>[e[42]||(e[42]=d(" بله "))]),_:1},8,["loading"]),s(y,{variant:"outlined",color:"#ccc",height:"42",class:"w-[calc(100%/2-8px)]",onClick:e[20]||(e[20]=o=>a.deleteConfirmation=!1)},{default:n(()=>e[43]||(e[43]=[l("span",{class:"text-black"},"خیر",-1)])),_:1})])])]),_:1})]),_:1},8,["modelValue"])])}const Ee=P(Z,[["render",ke]]);export{Ee as default};
